@model WebBack.Models.Biz.CarInsureOffer.DealtByOfferViewModel
@{
    ViewBag.Title = "Dealt";
    Layout = "~/Views/Shared/_LayoutHomeDialog.cshtml";
}
@section styles{
    <style type="text/css">
        .f-tb1-detail .t {
            width: 120px;
        }

        .f-tb1-detail .c {
            width: 280px;
        }
    </style>

}
@section scripts{

    <script type="text/javascript">

        var offerKinds= @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model.OrderToCarInsureOfferCompanyKind));
        var orderType=@((int)Model.OrderToCarInsure.Type)
        function loadOfferKindsTable(offerKinds){
            var obj_tbody=$('#list_table_offerkinds tbody');
            $(obj_tbody).html('');

            var html="";


            for(var i=0;i<offerKinds.length;i++)
            {
                html+="<tr>"
                html+="<td>"+offerKinds[i].kindName+"</td>";

                var kindv="";

                if(offerKinds[i].kindValue!=null)
                {
                    var kindu=offerKinds[i].kindUnit==null?"":offerKinds[i].kindUnit;
                    kindv=offerKinds[i].kindValue+kindu;
                }

                html+="<td>"+kindv+"</td>";

                var isWaiverDeductible=offerKinds[i].isWaiverDeductible==true?"不计免赔":"";

                html+="<td>"+isWaiverDeductible+"</td>";
                html+="<td>";

                html+=offerKinds[i].kindDetails==null?"":offerKinds[i].kindDetails;

                html+=" </td>";


                html+="<td>";


                html+="</td>";

                html+="</tr>"
            }

            $(obj_tbody).html(html);

        }

        var carmodels=[];
        $(document).ready(function () {

            var win = art.dialog.open.origin;
            var auditStatus = $.lumos.getUrlParamValue("auditStatus");
            if (auditStatus == "@((int)Lumos.Entity.Enumeration.CarInsureAuditStatus.WaitOffer)") {
                if (typeof win.listTable != "undefined") {
                    win.listTable.loadData();
                }
                if (typeof win.listTableTaskByVerify != "undefined") {
                    win.listTableTaskByCarInsOffer.loadData();
                }
            }

            @if (Model.IsHasOperater)
            {
                @Html.Raw("setTimeout(function () {art.dialog({ title: '提示', content: '用户【" + Model.OperaterName + "】正在审核', cancelVal:'退出',cancel: function () {art.dialog.close();}, lock: true, drag: false, dblclickClose: false }); }, 100);");
            }

            loadOfferKindsTable(offerKinds);


        });


    </script>
}

<form id="form1" name="form1">
    @AntiForgery.GetHtml()
    <input name="Model.OrderToCarInsure.Id" type="hidden" value="@Model.OrderToCarInsure.Id" />
    <input name="Model.BizProcessesAudit.CurrentDetails.Id" type="hidden" value="@Model.BizProcessesAudit.CurrentDetails.Id" />
    <input name="Model.BizProcessesAudit.CurrentDetails.BizProcessesAuditId" type="hidden" value="@Model.BizProcessesAudit.CurrentDetails.BizProcessesAuditId" />
    <input name="Model.OrderToCarInsure.CarModelName" type="hidden" id="Model_OrderToCarInsure_CarModelName" value="@Model.OrderToCarInsure.CarModelName" />
    @*<input name="Model.OrderToCarInsureAuto.DrivingLicenceFaceImgKey" value="@Model.OrderToCarInsureAuto.DrivingLicenceFaceImgKey" />
        <input name="Model.OrderToCarInsureAuto.IdentityCardFaceImgKey" value="@Model.OrderToCarInsureAuto.IdentityCardFaceImgKey" />*@
    @*<input name="Model.OrderToCarInsureAuto.CZ_CL_XSZ_ImgUrl" value="@Model.OrderToCarInsure.CZ_CL_XSZ_ImgUrl" />
        <input name="Model.OrderToCarInsureAuto.CZ_SFZ_ImgUrl" value="@Model.OrderToCarInsure.CZ_SFZ_ImgUrl" />*@

    <div class="gbr-row-title clearfix">
        <div class="pull-left">
            <h5>商户信息</h5>
        </div>
        <div class="pull-right f-tb1-item-pull-right">
            <h6></h6>
        </div>
    </div>

    <table class="f-tb1-detail">
        <tr>
            <td class="t">商户代码：</td>
            <td class="c">
                <span>@Model.Merchant.ClientCode</span>
            </td>
            <td class="t">商户名：</td>
            <td class="c">
                <span>@Model.Merchant.YYZZ_Name</span>
            </td>
        </tr>
        <tr>
            <td class="t">联系人：</td>
            <td class="c">
                <span>@Model.Merchant.ContactName</span>
            </td>
            <td class="t">联系电话：</td>
            <td class="c">
                <span>@Model.Merchant.ContactPhoneNumber</span>
            </td>
        </tr>
    </table>



    <div class="gbr-row-title clearfix">
        <div class="pull-left">
            <h5>险种信息</h5>

        </div>
        <div class="pull-right f-tb1-item-pull-right">
            <h6>@Lumos.BLL.BizFactory.CarInsurePlan.GetPlanName(Model.OrderToCarInsure.InsPlanId)</h6>
        </div>
    </div>
    <table id="list_table_offerkinds" class="list-tb" cellpadding="0" cellspacing="0">
        <thead>
            <tr>
                <th style="width:25%">
                    名称
                </th>
                <th style="width:25%">

                </th>
                <th style="width:20%">

                </th>
                <th style="width:25%">
                    投保明细
                </th>
                <th style="width:5%">

                </th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>


    <div class="gbr-row-title clearfix">
        <div class="pull-left">
            <h5>客户要求</h5>
        </div>
        <div class="pull-right f-tb1-item-pull-right">
            <h6></h6>
        </div>
    </div>
    <table class="f-tb1" cellpadding="0" cellspacing="1" style="width:96%">
        <tr>
            <td>
                @Model.OrderToCarInsure.ClientRequire
            </td>
        </tr>
    </table>

    <div class="gbr-row-title clearfix">
        <div class="pull-left">
            <h5>证件图片</h5>
        </div>
        <div class="pull-right f-tb1-item-pull-right">
            <h6></h6>
        </div>
    </div>


    <table class="f-tb1-detail" style="text-align:center">
        <tr style="vertical-align:top">
            <td>
                <div>
                    <span class="uploadimgbox" upload="false">
                        <span class="uploadimg">
                            <img src="@Model.OrderToCarInsure.CZ_CL_XSZ_ImgUrl" />
                        </span>
                        <span class="uploadimg-view" style="">预览</span>
                    </span>
                </div>
                <div>
                    <span>车辆行驶证</span>
                </div>
            </td>
            <td>
                <div>
                    <span class="uploadimgbox">
                        <span class="uploadimg">
                            <img src="@Model.OrderToCarInsure.CZ_SFZ_ImgUrl" />
                        </span>
                        <span class="uploadimg-view" style="">预览</span>
                    </span>
                </div>
                <div>
                    <span>身份证</span>
                    <input type="hidden" name="Model.OrderToCarInsure.CZ_SFZ_ImgUrl" value="@Model.OrderToCarInsure.CZ_SFZ_ImgUrl" />
                </div>
            </td>
            <td>
                <div>
                    <span class="uploadimgbox">
                        <span class="uploadimg">
                            <img src="@Model.OrderToCarInsure.CCSJM_WSZM_ImgUrl" />
                        </span>
                        <span class="uploadimg-view" style="">预览</span>
                    </span>
                </div>
                <div>
                    <span>车船税减免<br />或完税证明</span>
                </div>
            </td>
            <td>
                <div>
                    <span class="uploadimgbox">
                        <span class="uploadimg">
                            <img src="@Model.OrderToCarInsure.YCZ_CLDJZ_ImgUrl" />
                        </span>
                        <span class="uploadimg-view" style="@Model.OrderToCarInsure.YCZ_CLDJZ_ImgUrl">预览</span>
                    </span>
                </div>
                <div>
                    <span>验证照<br />或辆登记证</span>
                </div>
            </td>
            <td>
                <div>
                    <span class="uploadimgbox">
                        <span class="uploadimg">
                            <img src="@Model.OrderToCarInsure.ZJ1_ImgUrl" />
                        </span>
                        <span class="uploadimg-view" style="@Model.OrderToCarInsure.ZJ1_ImgUrl">预览</span>
                    </span>
                </div>
                <div>
                    <span>其他证件1</span>
                </div>
            </td>
            <td>
                <div>
                    <span class="uploadimgbox">
                        <span class="uploadimg">
                            <img src="@Model.OrderToCarInsure.ZJ2_ImgUrl" />
                        </span>
                        <span class="uploadimg-view" style="@Model.OrderToCarInsure.ZJ2_ImgUrl">预览</span>
                    </span>
                </div>
                <div>
                    <span>其他证件2</span>
                </div>
            </td>
            <td>
                <div>
                    <span class="uploadimgbox">
                        <span class="uploadimg">
                            <img src="@Model.OrderToCarInsure.ZJ3_ImgUrl" />
                        </span>
                        <span class="uploadimg-view" style="@Model.OrderToCarInsure.ZJ3_ImgUrl">预览</span>
                    </span>
                </div>
                <div>
                    <span>其他证件3</span>
                </div>
            </td>
            <td>
                <div>
                    <span class="uploadimgbox">
                        <span class="uploadimg">
                            <img src="@Model.OrderToCarInsure.ZJ4_ImgUrl" />
                        </span>
                        <span class="uploadimg-view" style="@Model.OrderToCarInsure.ZJ4_ImgUrl">预览</span>
                    </span>
                </div>
                <div>
                    <span>其他证件4</span>
                </div>
            </td>
        </tr>
    </table>

    <div class="gbr-row-title clearfix">
        <div class="pull-left">
            <h5>车辆查询</h5>
        </div>
        <div class="pull-right f-tb1-item-pull-right">
            <h6></h6>
        </div>
    </div>
    <table class="f-tb1-detail">
        <tr>
            <td class="t">品牌型号：</td>
            <td class="c">
                <span><input type="text" autocomplete="off" id="txt_Keyword" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarModelName" /></span>
            </td>
            <td class="t">车辆识别代号：</td>
            <td class="c">
                <span><input type="text" autocomplete="off" id="txt_Vin" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarVin" /></span>
            </td>
        </tr>
        <tr>
            <td class="t">初登日期：</td>
            <td class="c">
                <span><input type="text" autocomplete="off" id="txt_FirstRegisterDate" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarFirstRegisterDate" onclick="WdatePicker()" /></span>
                <span> <input type="button" class="btn" id="btn_CarModelQuery" value="查询" /></span>
            </td>
            <td class="t"></td>
            <td class="c"></td>
        </tr>
    </table>


    <table id="list_carmodel_table" class="list-tb" cellpadding="0" cellspacing="0">
        <thead>
            <tr>
                <th style="width:5%" class="no">
                    序号
                </th>
                <th style="width:10%">
                    车型代码
                </th>
                <th style="width:10%">
                    车型名称
                </th>
                <th style="width:10%">
                    排量（毫升）
                </th>
                <th style="width:10%">
                    上市年份
                </th>
                <th style="width:10%">
                    额定载客人数
                </th>
                <th style="width:10%">
                    新车购置价(元)
                </th>
                <th style="width:5%" class="operation">
                    操作
                </th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>



    <div class="gbr-row-title clearfix">
        <div class="pull-left">
            <h5>投保信息</h5>
        </div>
        <div class="pull-right f-tb1-item-pull-right">
            <h6></h6>
        </div>
    </div>

    <table class="f-tb1-detail">
        <tr>
            <td class="t"><span class="required-symbol">*</span>车主姓名：</td>
            <td class="c">
                <span><input name="Model.OrderToCarInsure.CarownerName" type="text" autocomplete="off" id="Model_OrderToCarInsure_CarownerName" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarownerName" /></span>
            </td>
            <td class="t">车主身份证号码：</td>
            <td class="c">
                <span> <input name="Model.OrderToCarInsure.CarownerCertNo" type="text" autocomplete="off" id="Model_OrderToCarInsure_CarownerCertNo" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarownerCertNo" /></span>
            </td>
        </tr>
        <tr>
            <td class="t"><span class="required-symbol">*</span>车牌号码：</td>
            <td class="c">
                <span><input name="Model.OrderToCarInsure.CarLicensePlateNo" type="text" autocomplete="off" id="Model_OrderToCarInsure_CarLicensePlateNo" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarLicensePlateNo" /></span>
            </td>
            <td class="t">车辆使用性质：</td>
            <td class="c">
                <span>@(Html.initEnumeration<Lumos.Entity.Enumeration.CarUserCharacter>(Lumos.Entity.Enumeration.InputType.Select, "Model.OrderToCarInsure.CarUserCharacter", new { @class = "select-control", defaulttext = "请选择", selectedvalue = new Lumos.Entity.Enumeration.CarUserCharacter[] { Model.OrderToCarInsure.CarUserCharacter }, hidevalue = new Lumos.Entity.Enumeration.CarUserCharacter[] { Lumos.Entity.Enumeration.CarUserCharacter.Unknow } }))</span>
            </td>
        </tr>
        <tr>
            <td class="t">品牌型号：</td>
            <td class="c">
                <span><input name="Model.OrderToCarInsure.CarModelName" type="text" autocomplete="off" id="Model_OrderToCarInsure_CarModelName" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarModelName" /></span>
            </td>
            <td class="t">车辆识别代号：</td>
            <td class="c">
                <span><input name="Model.OrderToCarInsure.CarVin" type="text" autocomplete="off" id="Model_OrderToCarInsure_CarVin" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarVin" /></span>
            </td>
        </tr>
        <tr>
            <td class="t">发动机号：</td>
            <td class="c">
                <span><input name="Model.OrderToCarInsure.CarEngineNo" type="text" autocomplete="off" id="Model_OrderToCarInsure_CarEngineNo" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarEngineNo" /></span>
            </td>
            <td class="t">核定载人数：</td>
            <td class="c">
                <span><input name="Model.OrderToCarInsure.CarRatedPassengerCapacity" type="text" autocomplete="off" id="Model_OrderToCarInsure_CarRatedPassengerCapacity" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarRatedPassengerCapacity" /></span>
            </td>
        </tr>
        <tr>
            <td class="t">车辆型号：</td>
            <td class="c">
                <span>@(Html.initEnumeration<Lumos.Entity.Enumeration.CarVechicheType>(Lumos.Entity.Enumeration.InputType.Select, "Model.OrderToCarInsure.CarVechicheType", new { @class = "select-control", defaulttext = "请选择", selectedvalue = new Lumos.Entity.Enumeration.CarVechicheType[] { Model.OrderToCarInsure.CarVechicheType }, hidevalue = new Lumos.Entity.Enumeration.CarVechicheType[] { Lumos.Entity.Enumeration.CarVechicheType.Unknow } }))</span>
            </td>
            <td class="t">初登日期：</td>
            <td class="c">
                <span><input name="Model.OrderToCarInsure.CarFirstRegisterDate" type="text" autocomplete="off" id="Model_OrderToCarInsure_CarFirstRegisterDate" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarFirstRegisterDate" onclick="WdatePicker()" /></span>
            </td>
        </tr>
        <tr>
            <td class="t">新车购置价：</td>
            <td class="c">
                <span><input name="Model.OrderToCarInsure.CarReplacementValue" type="text" autocomplete="off" id="Model_OrderToCarInsure_CarReplacementValue" class="input-control" style="width:175px;" value="@Model.OrderToCarInsure.CarReplacementValue" /></span>
            </td>
            <td class="t"></td>
            <td class="c"></td>
        </tr>
        <tr>
            <td class="t">承保期间（开始）：</td>
            <td class="c">
                @*<span><input type="text" class="input-control" name="Model.OrderToCarInsure.PeriodStart" id="Model_OrderToCarInsure_PeriodStart" onclick="WdatePicker({ minDate: '#F{$dp.$D(\'Model_OrderToCarInsure_PeriodStart\')}' })" style="width:175px;" value="@(Model.OrderToCarInsure.PeriodStart==null?DateTime.Now.AddDays(1).ToUnifiedFormatDate():Model.OrderToCarInsure.PeriodStart.ToUnifiedFormatDate())" /></span>*@
            </td>
            <td class="t"></td>
            <td class="c">
                <span>
                </span>
            </td>
            @*
                <td class="t"><span class="required-symbol">*</span>承保期间（结束）：</td>
                <td class="c">
                    <span><input type="text" class="input-control" name="Model.OrderToCarInsure.PeriodEnd" id="Model_OrderToCarInsure_PeriodEnd" onclick="WdatePicker({ minDate: '#F{$dp.$D(\'Model_OrderToCarInsure_PeriodEnd\')}' })" style="width:175px;" value="@Model.OrderToCarInsure.PeriodEnd.ToUnifiedFormatDate()" /></span>
                </td>*@
        </tr>
        <tr>
            <td class="c" colspan="4" style="text-align:center;">
                <span>

                    <span> <input type="button" class="btn" id="btn_GetCarInsOffer" value="获取报价" /></span>

                </span>
            </td>
        </tr>
    </table>
    <div class="gbr-row-title clearfix">
        <div class="pull-left">
            <h5>填写保险报价</h5>
        </div>
        <div class="pull-right f-tb1-item-pull-right">
            <h6></h6>
        </div>
    </div>

    <table id="list_table" class="list-tb" cellpadding="0" cellspacing="0">
        <thead>
            <tr>
                <th style="width:10%" class="no">
                    序号
                </th>
                <th style="width:20%">
                    保险公司
                </th>
                <th style="width:70%">
                    <span class="required-symbol">*</span>投保单图片
                </th>
            </tr>
        </thead>
        <tbody>

            @for (var i = 0; i < Model.OrderToCarInsureOfferCompany.Count; i++)
            {
                <tr id="offer_@Model.OrderToCarInsureOfferCompany[i].InsuranceCompanyId">
                    <td class="no">@(i + 1)</td>
                    <td class="overflow tipitem">
                        <span class="insurancecompanyname">@Model.OrderToCarInsureOfferCompany[i].InsuranceCompanyName</span>
                        <input name="Model.OrderToCarInsureOfferCompany[@i].Id" type="hidden" value="@Model.OrderToCarInsureOfferCompany[i].Id" />
                        <input name="Model.OrderToCarInsureOfferCompany[@i].InsuranceCompanyId" type="hidden" value="@Model.OrderToCarInsureOfferCompany[i].InsuranceCompanyId" />
                    </td>
                    <td>
                        <span class="uploadimgbox" upload="true">
                            <span class="uploadimg" inputname="Model.OrderToCarInsureOfferCompany[@i].InsureImgUrl" path="carInsure">
                                <img src="@Model.OrderToCarInsureOfferCompany[i].InsureImgUrl" class="insureimgurlsrc" />
                                <span class="uploadimg-click" style="">上传</span>
                                <input id="Model_OrderToCarInsureOfferCompany_InsureImgUrl_@i" value="@Model.OrderToCarInsureOfferCompany[i].InsureImgUrl" class="insureimgurl" name="Model.OrderToCarInsureOfferCompany[@i].InsureImgUrl" type="hidden" />
                            </span>
                            <span class="uploadimg-view" style="">预览</span>
                            <span class="insurancecompanyname" style="display:none">@Model.OrderToCarInsureOfferCompany[i].InsuranceCompanyName</span>
                        </span>

                    </td>
                </tr>
                <tr><td colspan="3" id="offer_extmsg_@Model.OrderToCarInsureOfferCompany[i].InsuranceCompanyId" style="text-align:center;color:red;"></td></tr>
            }
        </tbody>
    </table>


    @Html.Partial("AuditFlowTrace", Model.BizProcessesAudit.HistoricalDetails)

    <div class="gbr-row-title clearfix">
        <div class="pull-left">
            <h5>告知备注</h5>
        </div>
        <div class="pull-right f-tb1-item-pull-right">
            <h6></h6>
        </div>
    </div>
    <table class="f-tb1" cellpadding="0" cellspacing="1" style="width:96%">
        <tr>
            <td>
                <textarea name="Model.OrderToCarInsure.Remarks" class="input-control" id="Model_OrderToCarInsure_Remarks" style="width:98%;">@Model.OrderToCarInsure.Remarks</textarea>
            </td>
        </tr>
    </table>
</form>